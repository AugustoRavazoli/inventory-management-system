<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="layout/layout">

<body>

<main layout:fragment="content" x-data="{ currentForm: null }">

  <div class="navbar navbar-expand-lg py-4">
    <div class="container-fluid px-0">
      <h2 class="h4 mb-0 d-none d-sm-block">Orders</h2>
      <div class="d-flex justify-content-between">
        <form th:action="${#strings.isEmpty(param.name)} ? @{/orders/list?customer-name=} : @{/orders/list}" method="get"
              class="w-100 me-4">
          <div class="input-group w-100 bg-white">
            <input class="form-control rounded-0" type="search" name="customer-name" placeholder="Search order...">
            <button class="btn btn-outline-secondary rounded-0"><i
                th:class="${#strings.isEmpty(param.name)} ? 'bi bi-search' : 'bi bi-x-lg'"></i></button>
          </div>
        </form>
        <a th:href="@{/orders/create}" class="flex-shrink-0 btn btn-success px-4 rounded-0">Add order</a>
      </div>
    </div>
  </div>

  <div layout:replace="~{fragment/table :: table(
      headings=${ {'Bill No.', 'Customer', 'Date', 'Quantity', 'Amount', 'Actions'} }
    )}">
    <tbody layout:fragment="table-data">
    <th:block th:if="${orders.size() == 0}">
      <div th:replace="~{fragment/table :: row-empty(
            colspan=6
          )}"></div>
    </th:block>
    <th:block th:each="order : ${orders}">
      <div th:replace="~{fragment/table :: row(
            cells=${ { order.id, order.customer.name, order.date, order.quantity, '$ ' + order.amount} },
            updateUrl='/orders/update/__${order.id}__',
            deleteUrl='/orders/delete/__${order.id}__'
          )}"></div>
    </th:block>
    </tbody>
  </div>

  <div th:replace="~{fragment/pagination(
      url='/orders/list',
      currentPage=${currentPage},
      totalPages=${totalPages}
    )}"></div>

  <div th:replace="~{fragment/confirm-dialog}"></div>

</main>

</body>

</html>